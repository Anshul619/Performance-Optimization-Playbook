# API Performance & Scalability Optimization Playbook

> We should design a system that is inherently capable of meeting these performance goals.

This is a production-grade scalability checklist covering:
- Database scalability
- Application-layer scalability
- Infrastructure auto-scaling
- Architecture-level scalability patterns
- Failure isolation & load control mechanisms

> Legend
> - (Architecture) ‚Üí Advanced design patterns, usually requiring infra or system-level changes.
> - Priority: High ‚Üí quick wins / immediate impact, Medium ‚Üí medium effort, Low ‚Üí micro-optimizations.

# How to Use This Checklist?
- Start with High Priority items in **Identify & fix DB issues** and **Reduce unnecessary load**.
- Move on to improve resilience & scalability items for system stability.
- Consider **(Architecture)** points when planning larger design changes.
- Each row links to a deep dive in this repo or an external reference.

# Scalability Principles Table

| Principle                                         | Priority | Tag                                                   | Remarks                                                                                                                                                                                                                                                                                                                                                  |
|---------------------------------------------------|----------|-------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Ensure Observability                              | ‚≠ê High   | Pre-tuning requirement                                | [Observability](https://github.com/Anshul619/DevOps-SRE/blob/main/3_Observability), [Structured Logging](https://github.com/Anshul619/DevOps-SRE/blob/main/3_Observability/StructuredLogging.md), [profiling in Go](https://github.com/Anshul619/Golang/tree/main/Debugging%26Profiling) etc.                                                            |
| Profile Slow Query logs                           | ‚≠ê High   | Identify & fix DB issues (SQL-focused)                | Observe [Slow Query logs](https://severalnines.com/blog/how-identify-mysql-performance-issues-slow-queries/) to find poorly performing queries before making other changes.                                                                                                                                                                              |
| Understand [query planner](Query-Planner)         | ‚≠ê High   | Identify & fix DB issues (SQL-focused)                | Learn to read and interpret execution plans to pinpoint query bottlenecks. And [Optimize](SQL-Query-Optimizations/Readme.md) those to improve execution time.                                                                                                                                                                                                  |
| Indexing                                          | ‚≠ê High   | Identify & fix DB issues (SQL-focused)                | [Index the right columns](https://github.com/Anshul619/Database-Internals/blob/main/DataStructures/Index.md) to improve reads. <br/>- Index columns used in *WHERE, JOIN, HAVING, ORDER BY, GROUP BY*.                                                                                                                                                   |
| Avoid N+1 Query pattern                           | ‚≠ê High   | Identify & fix DB issues (SQL-focused)                | Replace multiple small queries with batched or joined queries to reduce DB round trips.                                                                                                                                                                                                                                                                  |
| NoSQL-specific query tuning tips                  | ‚≠ê High   | Identify & fix DB issues (NoSQL-focused)              | Optimize NoSQL queries using vendor-specific techniques (e.g. compound indexes in MongoDB, query filters in DynamoDB, partition keys in Cassandra).                                                                                                                                                                                                      |
| Caching                                           | ‚≠ê High   | Reduce unnecessary load                               | Use [redis](https://github.com/Anshul619/HLD-System-Designs/tree/main/1_Databases/8_Caching-InMemory-Databases/Redis/Readme.md) to cache frequently accessed read data and reduce DB hits.<br/>- Avoid caching large datasets that can degrade performance.                                                                                              |
| Pagination                                        | ‚≠ê High   | Reduce unnecessary load                               | Break large API response into [pages](https://github.com/Anshul619/HLD-System-Designs/tree/main/8_API-Protocols/Concepts/Pagination.md) using limit & offset (relay based) or cursors to prevent massive payloads.                                                                                                                                       |
| Tune Service tasks count & auto-scale             | ‚≠ê High   | Improve resilience & scalability                      | Right-size the number of service tasks (i.e. ECS Fargate tasks) to handle expected throughput without over-provisioning. <br/>- Use CPU/memory utilization or queue depth for auto-scaling.                                                                                                                                                              |
| DB Connection Pooling                             | ‚≠ê High   | Improve resilience & scalability                      | Maintain a pool of connections (with timeouts, max idle connections), instead of opening a new connection for every API request. <br/>- This would prevent **connection storms** or **resource exhaustion**.                                                                                                                                             |
| Use concurrency & async processing                | ‚≠ê High   | Improve resilience & scalability                      | Offload long-running or non-blocking tasks using [goroutines](https://github.com/Anshul619/Concurrency-Go/tree/main/GoRoutines.md), *worker pools*, or *async job execution*. <br/>- For inter-service async communication, use [message brokers (Kafka, RabbitMQ, SQS)](https://github.com/Anshul619/HLD-System-Designs/tree/main/2_MessageBrokersEDA). |
| Handle timeout                                    | ‚≠ê High   | Improve resilience & scalability                      | Use proper timeouts (e.g. [Go Contexts](https://github.com/Anshul619/Concurrency-Go/tree/main/Context)) to prevent cascading failures when upstream services fail or close connections early.                                                                                                                                                            |
| Graceful degradation / feature toggles            | ‚ö° Medium | Improve resilience & scalability                      | Temporarily disable non-essential or heavy features during peak load to keep core functionality responsive.                                                                                                                                                                                                                                              |
| Compression (payload-level)                       | üü¢ Low   | Reduce network cost                                   | Apply compression for large payloads to reduce bandwidth - avoid overusing on small payloads to save CPU.                                                                                                                                                                                                                                                |
| Asynchronous logging                              | üü¢ Low   | Reduce blocking operations                            | Buffer logs in memory and flush asynchronously to avoid blocking request processing with I/O operations.                                                                                                                                                                                                                                                 |
| JSON Serialization                                | üü¢ Low   | Reduce CPU cost                                       | Consider faster [JSON serialization library](https://github.com/Anshul619/Serialization-Data) for JSON-heavy APIs to reduce CPU time spent on encoding/decoding.                                                                                                                                                                                         |
| Use CDN to cache static resources                 | ‚ö° Medium | Reduce unnecessary load (Architecture)                | Use a [CDN](https://github.com/Anshul619/HLD-System-Designs/tree/main/4_Scalability/CDNs) to cache and serve static assets (images, CSS, JS) close to users, reducing server load and improving response times.                                                                                                                                          |
| Data archiving (hot vs cold storages)             | ‚ö° Medium | Reduce unnecessary load / storage cost (Architecture) | [Move old/infrequently accessed data](https://github.com/Anshul619/HLD-System-Designs/tree/main/1_Databases/3_Scalability-Techniques/DataArchiving.md) to cold storage (e.g. S3, Glacier) to reduce hot DB size and improve query performance.                                                                                                           |
| Backpressure handling                             | ‚≠ê High   | Improve resilience & scalability (Architecture)       | Implement load-shedding or **rate-limiting** to protect services under overload (e.g. HTTP 429, queue throttling).                                                                                                                                                                                                                                       |
| Read Replicas                                     | ‚ö° Medium | Improve resilience & scalability (Architecture)       | Use [read replicas](https://github.com/Anshul619/HLD-System-Designs/tree/main/1_Databases/3_Scalability-Techniques/ReadReplicaVsCache.md) to offload read traffic from the primary database.                                                                                                                                                             |
| Sharding                                          | ‚ö° Medium | Improve resilience & scalability (Architecture)       | Distribute data across multiple shards to improve [horizontal scalability](https://github.com/Anshul619/HLD-System-Designs/tree/main/1_Databases/3_Scalability-Techniques/PartitioningSharding), consider complexity and operational cost before implementing.                                                                                           |
| Use appropriate databases based on query patterns | ‚ö° Medium | Improve resilience & scalability (Architecture)       | Choose the right DB engine for your [access patterns](https://github.com/Anshul619/HLD-System-Designs/tree/main/1_Databases/DatabaseDesign.png) ‚Äî SQL for relational joins, Elasticsearch for search, MongoDB/DynamoDB for document or key-value access.                                                                                                 |
| Choose appropriate architecture style             | ‚ö° Medium | Improve resilience & scalability (Architecture)       | Decide between [monolith and microservices](https://github.com/Anshul619/HLD-System-Designs/tree/main/3_MicroServices/MonoToMicroServices.md) based on expected scale, team structure, and latency tolerance. <br/>- Avoid premature microservices, as network costs can hurt.                                                                           |
| Async batch processing for heavy workloads        | ‚ö° Medium | Improve resilience & scalability (Architecture)       | Move heavy [aggregation/analytics tasks](https://github.com/Anshul619/HLD-System-Designs/tree/main/1_Databases/OLTPvsOTAP.md) to asynchronous jobs instead of real-time APIs to keep request latency low.                                                                                                                                                |

# Read more
- [Top 7 Ways to 10x Your API Performance](https://www.youtube.com/watch?v=zvWKqUiovAM)
- [SQL Tunning - Donnemartin](https://github.com/donnemartin/system-design-primer#sql-tuning)
- [Understanding caching in Postgres - An in-depth guide](https://madusudanan.com/blog/understanding-postgres-caching-in-depth/)
- [Tuning Input/Output (I/O) Operations for PostgreSQL](https://severalnines.com/blog/tuning-io-operations-postgresql/)
- [Secret To Optimizing SQL Queries - Understand The SQL Execution Order](https://www.youtube.com/watch?v=BHwzDmr6d7s)
- [Analyzing Amazon RDS Database Workloads with Performance Insights](https://aws.amazon.com/blogs/database/analyzing-amazon-rds-database-workload-with-performance-insights/)
- [How does SQL trigger affect performance?](https://stackoverflow.com/questions/56990262/how-does-sql-trigger-affect-performance)
